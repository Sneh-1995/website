<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register — MySite</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width:600px; margin:auto; }
    .card { border:1px solid #eee; padding:16px; border-radius:8px; box-shadow: 0 1px 3px rgba(0,0,0,0.04); }
    input, button { padding:10px; margin:8px 0; width:100%; box-sizing:border-box; }
    button { cursor:pointer; background:#1a73e8; color:#fff; border:none; border-radius:4px; }
    .msg { margin-top:12px; color:green; display:none; }
    .err { margin-top:12px; color:red; display:none; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Register करें</h2>
    <form id="regForm">
      <input id="name" name="name" type="text" placeholder="आपका नाम" required />
      <input id="email" name="email" type="email" placeholder="आपका ईमेल" required />
      <input type="hidden" name="source" value="github-pages" />
      <button id="submitBtn" type="submit">रजिस्टर करें</button>
    </form>

    <div class="msg" id="successMsg">धन्यवाद! आपका फॉर्म मिल गया — थोड़ी देर में redirect होगा…</div>
    <div class="err" id="errMsg">कुछ गलती हुई। कृपया बाद में कोशिश करें।</div>
  </div>

<script>
document.getElementById('regForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  document.getElementById('errMsg').style.display = 'none';
  document.getElementById('successMsg').style.display = 'none';
  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.textContent = 'Submitting...';

  const form = e.target;
  const data = new FormData(form);

  try {
    const res = await fetch('https://formspree.io/f/mnngerba', {
      method: 'POST',
      headers: { 'Accept': 'application/json' },
      body: data
    });

    if (res.ok) {
      document.getElementById('successMsg').style.display = 'block';
      setTimeout(() => {
        window.location.href = '/thankyou.html';
      }, 1000);
    } else {
      const json = await res.json().catch(()=>null);
      document.getElementById('errMsg').textContent = (json && json.error) ? json.error : 'Submission failed';
      document.getElementById('errMsg').style.display = 'block';
      btn.disabled = false;
      btn.textContent = 'रजिस्टर करें';
    }
  } catch (err) {
    document.getElementById('errMsg').textContent = 'नेटवर्क त्रुटि — कृपया बाद में आज़माएँ';
    document.getElementById('errMsg').style.display = 'block';
    btn.disabled = false;
    btn.textContent = 'रजिस्टर करें';
  }
});
</script>
</body>
</html>
